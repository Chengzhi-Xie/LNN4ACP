# LNN4ACP
LNN4ACP is a novel stacked framework that integrates both machine learning and deep learning components for accurate ACP identification and virtual generation.

## Structure
<img width="4302" height="3384" alt="LNN4ACP" src="https://github.com/user-attachments/assets/de868e08-f98c-4e9e-a5c7-3b739b59d3d4" />
<img width="2752" height="1222" alt="Gemini_Generated_Image_41h2641h2641h264" src="https://github.com/user-attachments/assets/e7bcbf47-750a-47ce-8fc9-c43744180fde" />
Schematic illustration of the LNN4ACP framework. (A) Overview of the LNN4ACP predictor architecture, which comprises four main components: feature extraction, initial prediction using machine learning classifiers, feature refinement via a CfC LNN, and final classification. (B) Representation of the first module, including feature fusion and predictions generated by four distinct machine learning classifiers (RF, XGBoost, LightGBM, and HistGradientBoosting). (C) Structure of CfC LNN module, consisting of five sequential layers with multiple blocks, followed by the terminal classification and PCA layer. (D) LNN4ACP Generator consists of a frozen predictor and a GA-driven design loop that generates candidates by initialization, selection, crossover, and mutation, evaluates each peptide with an LNN-only potency module (meta-level LNN and sequence-level LNN), applies auxiliary safety gating (hemolysis/cytotoxicity) together with developability and 3-mer novelty scoring, and outputs globally ranked top candidates for archiving.

## Dependencies
* python==3.10

* torch==2.4.1
* torchvision==0.19.1
* torchaudio==2.4.1

* numpy==1.26.4
* pandas==2.2.2
* scikit-learn==1.5.2
* scipy==1.14.1
* joblib==1.4.2

* xgboost==2.1.1
* catboost==1.2.7
* lightgbm==4.5.0

* matplotlib==3.9.2
* seaborn==0.13.2
* plotly==5.24.1

* tensorflow==2.15.0
* openpyxl==3.1.2

* ncps==1.0.1
* lightgbm==4.6.0
* xgboost==3.1.2

* transformers==4.44.1
* tokenizers==0.19.1
* huggingface-hub==0.24.6
* sentencepiece==0.2.0
* accelerate==1.0.1
* transformers datasets accelerate einops==4.57.3
* tqdm==4.67.1
* umap-learn==0.5.9.post2

## Installation
1. Create a new environment: `<conda>` 
```conda create -n LNN4ACP python=3.10```
2. Activate the environment:
```conda activate LNN4ACP```
3. Install LNN4ACP in the environment:
```pip install numpy==1.26.4```
...

## Datasets
antiCP2.txt is the main ACP dataset for training and testing LNN4ACP.
mACP.txt is the ACP external testing dataset for testing LNN4ACP's generalization.

## Codes
The description can be find in each files fold

## Contact
If you have any questions, comments, or would like to report a bug, please file a Github issue or contact me.
